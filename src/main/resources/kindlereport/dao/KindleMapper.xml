<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kindlereport.dao.KindleMapper">

	<select id="selectTodayKindleList" resultType="kindlereport.model.Kindle">
		select
			*
		from
			Kindle
		where
			releaseDate = #{date}
	</select>
	
	<select id="selectKindle" resultType="java.util.Map">
		select
			asin,
			title,
			releaseDate,
			detailPageURL,
			largeImage
		from
			Kindle
		where
			asin = #{asin}
	</select>
	
	<select id="selectExclusion" resultType="java.lang.String">
		select
			'%'||word||'%'
		from
			EXCLUSION
		where
			active = 1
	</select>
	
	<select id="selectKindleList" resultType="kindlereport.model.Kindle" parameterType="java.lang.Integer">
		select
			*
		from
			Kindle
		order by
		<choose>
			<when test="order == null or order == 1">
				releaseDate desc
			</when>
			<when test="order == 2">
				releaseDate asc
			</when>
			<otherwise>
				releaseDate desc
			</otherwise>
		</choose>
		LIMIT #{limit} OFFSET #{offset}
	</select>
	
	<select id="selectRereaseDateList" parameterType="java.lang.String" resultType="java.lang.String">
<!-- 		select distinct releaseDate from Kindle order by releaseDate desc LIMIT 10 -->
		select distinct releaseDate from Kindle where releaseDate >= #{date} order by releaseDate
	</select>
	
	<select id="selectDayKindleList" parameterType="java.lang.String" resultType="kindlereport.model.Kindle">
		select * from Kindle where releaseDate = #{releaseDate} order by releaseDate desc
	</select>
	
	<select id="selectKindleByAsin" resultType="kindlereport.model.Kindle">
		select
			asin,
			author,
			binding,
			format,
			isAdultProduct,
			label,
			manufacturer,
			productGroup,
			productTypeName,
			publicationDate,
			publisher,
			releaseDate,
			title,
			content,
			detailPageURL,
			largeImage,
			mediumImage
		from
			Kindle
		where
			asin = #{asin}
	</select>
</mapper>
